<!DOCTYPE html>
<html lang="en">
<head>
  <title>How to X</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">

  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>

  <style>
     body {
       font-family: Roboto, sans-serif, arial;
       margin: 0;
     }

     #titlebar {
       padding: 12px 51px 12px 18px;
       border-bottom: 1px solid #add6ff;
       background-color: #d6ebff;
       position: relative;
       font-size: 20px;
       color: #333;
       min-height: 24px;
     }
     #back {
       display: none;
       position: absolute;
       top: 0;
       fill: #333;
       margin-left: -18px;
     }
     svg {
       padding: 13px;
     }
     #title {
       display: block;
     }
     #view {
       position: absolute;
       right: 16px;
       top: 0;
       fill: #333;
       font-style: italic;
       margin-right: -16px;
     }
     #add {
       background-color: #d6ebff;
       border-radius: 32px;
       border: 1px solid #add6ff;
       color: #333;
       font-size: 20px;
       margin: 12px;
       padding: 8px 16px;
       position: absolute;
       right: 0;
     }

     #list {
       list-style-type: none;
       margin: 0;
       padding: 0;
     }
     #list li {
       background: white;
       border: none;
       box-shadow: 0 1px 2px 1px #ccc;
       font-size: 18px;
       min-height: 48px;
       padding: 2px 8px 2px 37px;
       position: relative;
     }
     #list .drag-icon {
       position: absolute;
       top: 0;
       left: 0;
     }
     #list .edit-icon {
       position: absolute;
       top: 0;
       right: 0;
     }
     #list .item {
       display: block;
       padding: 13px;
       margin-right: 34px;
     }
     #list .input {
       font-family: Roboto, sans-serif, arial;
       padding: 8px;
       width: 100%;
       margin: -9px -9px;
       font-size: 18px;
       min-height: 20px;
     }
     #list .input:focus {
       box-shadow: inset 0 0 4px 1px #add6ff;
       border: 1px solid #9dc6ef;
       outline: none;
       color: #2471bf;
     }
  </style>

  <script>
    var root = "How to X";
    var tree = {
      'Financial Aid': {
        'How to compute cost': {
          'How to estimate tuition': null,
          'Cost of housing': null,
          'Cost of books': null,
          'Cost of living': null,
        },
        'How to get scholarships': null,
        'How to apply for fafsa': null,
        'How to obtain transfer of financial aid funds': null,
        'How to get student loan': null,
        'How to retain qualification for student loan': null,
        'How to refinance student loan': null,
        'How to manage student debt': null,
        'How to refinance student loan': null,
        'How to get student loan forgiveness': null,
      },
      'Civic services': {
        'How to get unemployment benefits': null,
      },
      Miscellaneous: {
        'How to play chess': null,
        'How to water plants': null,
        'How to draw something': null,
      },
    };

    $(document).ready(function() {
      // Where are we?
      var qidx = location.href.indexOf('#');
      var query = '';
      if (qidx != -1) query = unescape(location.href.substr(qidx+1)) + '/';

      var node = root;
      var children = tree;
      while (true) {
        var idx = query.indexOf('/');
        if (idx == -1) break;
        node = query.substr(0, idx);
        children = children[node];
        query = query.substr(idx + 1);
      }

      // Title.
      if (node != root) {
        $('#back').show();
        $('#title').css('margin-left', '34px');
      }
      $('#title').text(node);
      $("#titlebar").disableSelection();

      // List.
      function visitFn(e) {
        window.location.hash += (window.location.hash == '' ? '' : '/') + e.data;
      }
      $(window).on('hashchange', function() { location.reload(); });

      var dragSVG = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#555"><path d="M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/><path d="M0 0h24v24H0V0z" fill="none"/></svg>';
      var editSVG = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#555"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/><path d="M0 0h24v24H0z" fill="none"/></svg>';

      function addItem(child) {
        var editElement = $('<span/>', { "class": "edit-icon" }).append(editSVG).click(editFn);
        $('#list').append(
          $('<li/>', { "class": "row ui-state-default ui-sortable-handle" }).append(
            $('<span/>', { "class": "drag-icon" }).append(dragSVG),
            $('<span/>', { "class": "item" }).click(child, visitFn).text(child),
            editElement));
        return editElement;
      }
      for (var child in children) {
        addItem(child);
      }

      $("#list").sortable({ handle: '.drag-icon' });
      document.getSelection().removeAllRanges();
      $("#list").disableSelection();

      // List editing.
      function editFn() {
        var item = $(this).parent().find('.item');
        // item.off("click");
        var text = item.text();
        item.html('');
        item.val(text);
        $("#list").enableSelection();

        function blurFn(e, p) {
          var me = $(this).parent().find('input').remove().end();
          me.text(p == "escape" ? me.val() : $(this).val());
          // Special case: if value is empty then delete the item.
          if (me.text() == "") me.parent().remove();
          document.getSelection().removeAllRanges();
          $("#list").disableSelection();
        };

        function keyUpFn(e) {
          if (e.keyCode == 13) $(this).trigger("blur");
          else if (e.keyCode == 27) $(this).trigger("blur", "escape");
        }

        $('<input/>')
          .addClass('input')
          .blur(blurFn)
          .bind("keyup", keyUpFn)
          .appendTo(item)
          .focus()
          .val(text)
          .scrollLeft(10000);
      }

      // Add.
      function addFn() {
        addItem("").trigger("click");
      }
      $("#add").click(addFn);

      /*
        // delete (trash icon)
        // label vs. query
        // ... persist for the user, cross-reviews, etc.
        // ... v2: forks, steps vs. options, taking user input
        // DO THIS COLLABORATIVELY
      */
    });
  </script>
</head>
<body>

<div id="titlebar">
  <span id="back" onClick="history.back()">
    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px">
      <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg></span>
  <span id="title">How to X</span>
  <span id="view">
    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px">
      <path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm12 15.59l-2.2-2.2c.44-.69.7-1.51.7-2.39 0-2.48-2.02-4.5-4.5-4.5S7.5 10.52 7.5 13s2.02 4.5 4.5 4.5c.88 0 1.69-.26 2.39-.7l3.2 3.2H6V4h7.17L18 8.83v8.76zm-6-2.09c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/><path d="M0 0h24v24H0V0z" fill="none"/></svg></span>
</div>

<ul id="list" class="ui-sortable"></ul>

<div id="add">+</div>

</body>
</html>
